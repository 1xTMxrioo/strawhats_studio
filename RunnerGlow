local Players = game:GetService("Players")
local Teams = game:GetService("Teams")
local runnersTeam = Teams:FindFirstChild("Runners")
local chasersTeam = Teams:FindFirstChild("Chasers")

if not runnersTeam then
    warn("Runners team not found!")
end

if not chasersTeam then
    warn("Chasers team not found!")
end

if not runnersTeam and not chasersTeam then
    return
end

local function addEffectsToCharacter(character, teamType)
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    local head = character:FindFirstChild("Head")
    if not head then return end
    
    local existingGlow = humanoidRootPart:FindFirstChild("TeamGlow")
    if existingGlow then
        existingGlow:Destroy()
    end
    
    local existingTag = head:FindFirstChild("NameTag")
    if existingTag then
        existingTag:Destroy()
    end
    
    local glowColor, tagText, bgColor
    
    if teamType == "runner" then
        glowColor = Color3.fromRGB(0, 100, 255)
        tagText = "RUNNER"
        bgColor = Color3.fromRGB(0, 50, 150)
    elseif teamType == "chaser" then
        glowColor = Color3.fromRGB(255, 50, 50)
        tagText = "CHASER"
        bgColor = Color3.fromRGB(150, 0, 0)
    else
        return
    end
    

    local glow = Instance.new("PointLight")
    glow.Name = "TeamGlow"
    glow.Color = glowColor
    glow.Brightness = 2
    glow.Range = 15
    glow.Shadows = true
    glow.Parent = humanoidRootPart
    

    local billboard = Instance.new("BillboardGui")
    billboard.Name = "NameTag"
    billboard.Size = UDim2.new(0, 100, 0, 30)
    billboard.StudsOffset = Vector3.new(0, 2.5, 0) 
    billboard.AlwaysOnTop = true
    billboard.MaxDistance = 50
    billboard.Parent = head
    

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.BackgroundColor3 = bgColor
    frame.BackgroundTransparency = 0.2
    frame.BorderSizePixel = 0
    frame.Parent = billboard
    
 
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = frame
    
   
    local shadow = Instance.new("UIStroke")
    shadow.Color = Color3.fromRGB(0, 0, 0)
    shadow.Transparency = 0.5
    shadow.Thickness = 2
    shadow.Parent = frame
    
   
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = tagText
    label.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text
    label.TextScaled = true
    label.Font = Enum.Font.GothamBold
    label.Parent = frame
    
    -- Add text shadow effect
    local textStroke = Instance.new("UIStroke")
    textStroke.Color = Color3.fromRGB(0, 0, 0)
    textStroke.Transparency = 0.7
    textStroke.Thickness = 1
    textStroke.Parent = label
end

local function removeEffectsFromCharacter(character)
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if humanoidRootPart then
        local glow = humanoidRootPart:FindFirstChild("TeamGlow")
        if glow then
            glow:Destroy()
        end
    end
    
    local head = character:FindFirstChild("Head")
    if head then
        local nameTag = head:FindFirstChild("NameTag")
        if nameTag then
            nameTag:Destroy()
        end
    end
end

local function onPlayerAdded(player)
   
    player.CharacterAdded:Connect(function(character)
        if player.Team == runnersTeam then
            addEffectsToCharacter(character, "runner")
        elseif player.Team == chasersTeam then
            addEffectsToCharacter(character, "chaser")
        end
    end)
    
    
    player:GetPropertyChangedSignal("Team"):Connect(function()
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            if player.Team == runnersTeam then
                addEffectsToCharacter(player.Character, "runner")
            elseif player.Team == chasersTeam then
                addEffectsToCharacter(player.Character, "chaser")
            else
                removeEffectsFromCharacter(player.Character)
            end
        end
    end)
   
    if player.Character then
        if player.Team == runnersTeam then
            addEffectsToCharacter(player.Character, "runner")
        elseif player.Team == chasersTeam then
            addEffectsToCharacter(player.Character, "chaser")
        end
    end
end


Players.PlayerAdded:Connect(onPlayerAdded)


for _, player in Players:GetPlayers() do
    onPlayerAdded(player)
end
